const { Telegraf, Markup, Scenes, session } = require('telegraf');
const { getAllCollections } = require('./collection_controller');
require('dotenv').config();

const sceneDeleteCollection = require('./scenes/delete_collection');
const sceneAddCollection = require('./scenes/add_collection');

const bot = new Telegraf(process.env.BOT_TOKEN);
bot.use(session())
const stage = new Scenes.Stage([sceneDeleteCollection, sceneAddCollection]);
bot.use(stage.middleware())

//Ð’Ð¡Ð¢Ð£ÐŸÐÐ Ð†ÐÐ¤Ð
bot.start((ctx) => {
    ctx.replyWithPhoto({ source: 'src/1.JPG' },
        {
            caption: `ðŸ’¸ÐšÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚Ð° (ÑÐ¾ÐºÑ€Ð°Ñ‰ÐµÐ½Ð½Ð¾ Â«ÐºÑ€Ð¸Ð¿Ñ‚Ð°Â») â€” ÑÑ‚Ð¾ Ñ„Ð¾Ñ€Ð¼Ð° Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð²Ð°Ð»ÑŽÑ‚Ñ‹, Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÑŽÑ‰Ð°Ñ Ð¾ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð»ÑÑ‚ÑŒ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ðµ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… ÑÑ€ÐµÐ´ÑÑ‚Ð². 
ðŸ’¸Ð’ Ð¾Ñ‚Ð»Ð¸Ñ‡Ð¸Ðµ Ð¾Ñ‚ Ñ„Ð¸Ð°Ñ‚Ð½Ñ‹Ñ… Ð²Ð°Ð»ÑŽÑ‚, Ñ‚Ð°ÐºÐ¸Ñ… ÐºÐ°Ðº Ð´Ð¾Ð»Ð»Ð°Ñ€ Ð¡Ð¨Ð Ð¸Ð»Ð¸ ÐµÐ²Ñ€Ð¾, Ð½ÐµÑ‚ Ñ†ÐµÐ½Ñ‚Ñ€Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¾Ñ€Ð³Ð°Ð½Ð°, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ Ð¸Ð»Ð¸ Ð²Ð»Ð¸ÑÐµÑ‚ Ð½Ð° ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚Ñ‹.

ðŸ’¸Ð‘Ð¾Ð»ÑŒÑˆÐ°Ñ Ñ‡Ð°ÑÑ‚ÑŒ ÐºÑ€Ð¸Ð¿Ñ‚Ñ‹ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ñ‡ÐµÑ€ÐµÐ· Ð±Ð»Ð¾ÐºÑ‡ÐµÐ¹Ð½, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð´ÐµÐ¹ÑÑ‚Ð²ÑƒÐµÑ‚ ÐºÐ°Ðº Ð¾Ð±Ñ‰ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ð¹ Ð¶ÑƒÑ€Ð½Ð°Ð», Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ñ‹Ð¹ Ð¿Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ð¼Ñƒ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ñƒ ÐºÐ¾Ð¼Ð¿ÑŒÑŽÑ‚ÐµÑ€Ð¾Ð²,
Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼ Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÑŽÑ‚ÑÑ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸, ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð¸Ñ€ÑƒÐµÑ‚ÑÑ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð½Ð¾Ð²Ñ‹Ñ… Ð¼Ð¾Ð½ÐµÑ‚ Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ÑÑ Ð¿Ñ€Ð°Ð²Ð¾ ÑÐ¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸`,
            parse_mode: "Markdown",
            ...Markup.inlineKeyboard([
                Markup.button.callback("Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ NFT?", "more"),
            ]),
        });
});

bot.action("more", (ctx, next) => {
    ctx.replyWithPhoto({ source: 'src/2.JPG' },
        {
            caption: `ðŸ’¸NFT â€” ÑÑ‚Ð¾ Ð½ÐµÐ²Ð·Ð°Ð¸Ð¼Ð¾Ð·Ð°Ð¼ÐµÐ½ÑÐµÐ¼Ñ‹Ð¹ Ñ‚Ð¾ÐºÐµÐ½, Ð°Ð±Ð±Ñ€ÐµÐ²Ð¸Ð°Ñ‚ÑƒÑ€Ð° Ð°Ð½Ð°Ð»Ð¾Ð³Ð¸Ñ‡Ð½Ð¾Ð¹ Ð¿Ð¾ ÑÐ¼Ñ‹ÑÐ»Ñƒ Ð°Ð½Ð³Ð»Ð¾ÑÐ·Ñ‹Ñ‡Ð½Ð¾Ð¹ Ñ„Ð¾Ñ€Ð¼ÑƒÐ»Ð¸Ñ€Ð¾Ð²ÐºÐ¸ â€” non-fungible token 
ðŸ’¸Ð•ÑÐ»Ð¸ 1 BTC Ð¸Ð»Ð¸ ETH Ñ€Ð°Ð²ÐµÐ½ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð¾Ð¼Ñƒ ÑÐºÐ²Ð¸Ð²Ð°Ð»ÐµÐ½Ñ‚Ñƒ Ð² Ñ‚Ð¾Ð¹ Ð¶Ðµ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚Ðµ Ð¸Ð»Ð¸ Ð¼Ð¾Ð¶ÐµÑ‚ Ð´Ñ€Ð¾Ð±Ð¸Ñ‚ÑŒÑÑ Ð½Ð° Ð¼ÐµÐ½ÑŒÑˆÐ¸Ðµ Ñ‡Ð°ÑÑ‚Ð¸, Ñ‚Ð¾ ÐºÐ°Ð¶Ð´Ñ‹Ð¹ NFT ÑÐºÐ²Ð¸Ð²Ð°Ð»ÐµÐ½Ñ‚ÐµÐ½ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ°Ð¼Ð¾Ð¼Ñƒ ÑÐµÐ±Ðµ. ÐŸÑ€Ð¸ ÑÑ‚Ð¾Ð¼ Ð¾Ð½ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¸Ð¼ÐµÑ‚ÑŒ Ñ†ÐµÐ½Ñƒ, ÐºÐ¾Ñ‚Ð¾Ñ€ÑƒÑŽ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÑ‚ Ñ€Ñ‹Ð½Ð¾Ðº, Ð½Ð¾ Ð¾Ð± ÑÑ‚Ð¾Ð¼ Ð¿Ð¾Ð·Ð¶Ðµ
ðŸ’¸NFT â€” ÑÑ‚Ð¾ Ñ†Ð¸Ñ„Ñ€Ð¾Ð²Ð¾Ð¹ ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚, Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´Ð°ÑŽÑ‰Ð¸Ð¹ Ñ„Ð°ÐºÑ‚ Ð²Ð»Ð°Ð´ÐµÐ½Ð¸Ñ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ð¼ Ñ†Ð¸Ñ„Ñ€Ð¾Ð²Ñ‹Ð¼ Ð°ÐºÑ‚Ð¸Ð²Ð¾Ð¼. 

ðŸ’¸Ð¡Ð°Ð¼ Ñ‚Ð¾ÐºÐµÐ½ Ð½Ðµ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ Ð¸ÑÐºÑƒÑÑÑ‚Ð²Ð°, Ð° Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÑÑ‹Ð»ÐºÑƒ Ð½Ð° Ð½ÐµÐ³Ð¾ Ð¸ ÑÐ¼Ð°Ñ€Ñ‚-ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚, Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÑŽÑ‰Ð¸Ð¹ Ð¿Ñ€Ð°Ð²Ð° Ð²Ð»Ð°Ð´ÐµÐ»ÑŒÑ†Ð° Ð¸ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð°ÐºÑ‚Ð¸Ð²Ð¾Ð¼.
ðŸ’¸Ð’ Ð±Ð»Ð¾ÐºÑ‡ÐµÐ¹Ð½-ÑÐµÑ‚Ð¸ Ð¼Ð¾Ð¶Ð½Ð¾ Ð½Ð°Ð¹Ñ‚Ð¸ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾Ð±Ð¾ Ð²ÑÐµÑ… Ð²Ð»Ð°Ð´ÐµÐ»ÑŒÑ†Ð°Ñ… Ð²Ð¿Ð»Ð¾Ñ‚ÑŒ Ð´Ð¾ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾.
ðŸ’¸Ð˜Ð·Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾ NFT Ð·Ð°Ð´ÑƒÐ¼Ñ‹Ð²Ð°Ð»ÑÑ ÐºÐ°Ðº Ñ‚ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ ÑÑ€ÐµÐ´ÑÑ‚Ð²Ð¾ Ð´Ð»Ñ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð°Ð¼Ð¸ ÑÐ¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ð¹ Ð² Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾Ð¹ ÑÐµÑ‚Ð¸, Ð¾Ð´Ð½Ð°ÐºÐ¾ Ð½Ð° Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐµ ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸Ñ ÑÐ»Ð¾Ð¶Ð¸Ð»Ð°ÑÑŒ Ð¸Ð½Ð°Ñ‡Ðµ`,
            parse_mode: "Markdown",
            ...Markup.inlineKeyboard([
                Markup.button.callback("Ð“Ð´Ðµ ÐºÑƒÐ¿Ð¸Ñ‚ÑŒ NFT?", "more2"),
            ]),
        });
});

bot.action("more2", (ctx, next) => {
    ctx.replyWithPhoto({ source: 'src/3.JPG' },
        {
            caption: `ðŸ’¸Opensea ÑÑ‚Ð¾ Ð¾Ð´Ð¸Ð½ Ð¸Ð· ÐºÑ€ÑƒÐ¿Ð½ÐµÐ¹ÑˆÐ¸Ñ… Ñ†Ð¸Ñ„Ñ€Ð¾Ð²Ñ‹Ñ… Ñ€Ñ‹Ð½ÐºÐ¾Ð² ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ñ‚Ð¾ÐºÐµÐ½Ð¾Ð². ÐžÐ¿ÐµÐ½ÑÐ¸Ð° Ð½Ð°Ñ‡Ð°Ð»Ð° ÑÐ²Ð¾ÑŽ Ð´ÐµÑÑ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð² 2017 Ð¿Ñ€Ð¸ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐµ Ð²ÐµÐ½Ñ‡ÑƒÑ€Ð½Ð¾Ð³Ð¾ Ñ„Ð¾Ð½Ð´Ð° ÐÐ½Ð´Ñ€Ðµ Ð“Ð¾Ñ€Ð¾Ð²Ð¸Ñ†Ð°. ÐŸÐ»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð° Ñ€Ð°ÑÐ¿Ð¾Ð»Ð°Ð³Ð°ÐµÑ‚ Ð¾Ð±ÑˆÐ¸Ñ€Ð½Ð¾Ð¹ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¾Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚Ð° Ð¿Ð¾ Ð²ÑÐµÐ¼ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸ÑÐ¼.

ðŸ’¸Ð—Ð´ÐµÑÑŒ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¸Ð½ÑÑ‚Ð²Ð¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ñ… Ð²Ð¸Ð´Ð¾Ð² NFT Ð½Ð°Ñ‡Ð¸Ð½Ð°Ñ Ð¾Ñ‚ Ñ†Ð¸Ñ„Ñ€Ð¾Ð²Ð¾Ð³Ð¾ Ð¸ÑÐºÑƒÑÑÑ‚Ð²Ð° Ð¸ Ð·Ð°ÐºÐ°Ð½Ñ‡Ð¸Ð²Ð°Ñ 3D-Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°Ð¼Ð¸ ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°Ð¼Ð¸, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ð¼Ð¸ Ð² Ð²Ð¸Ð´ÐµÐ¾Ð¸Ð³Ñ€Ð°Ñ…. OpenSea Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð° Ð´Ð»Ñ Ð½Ð¾Ð²Ð¸Ñ‡ÐºÐ¾Ð², Ñ‡Ñ‚Ð¾ Ð¾Ð±Ð»ÐµÐ³Ñ‡Ð°ÐµÑ‚ Ð½Ð°Ñ‡Ð°Ð»Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹.`,
            parse_mode: "Markdown",
            ...Markup.inlineKeyboard([
                Markup.button.callback("ÐšÑƒÐ¿Ð¸Ñ‚ÑŒ NFT", "buy"),
            ]),
        });
});

//ÐŸÐžÐšÐ£ÐŸÐšÐ ÐÐ¤Ð¢
bot.action("buy", async (ctx) => {
    await ctx.reply(`ðŸ’¸Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ Ð´Ð»Ñ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸ ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ð¸ :`);

    (await getAllCollections()).forEach((element) => {
        ctx.reply(`ðŸ’¸Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸ÑŽ - ${element.link}\nðŸ’¸Ð¦ÐµÐ½Ð° : ${element.price}$`, Markup.inlineKeyboard([
            Markup.button.callback("ÐšÑƒÐ¿Ð¸Ñ‚ÑŒ!", `buy_nft ${element.id}`),
        ]))
    })
});

bot.action(/buy_nft/, (ctx, next) => {
    const id = ctx.match.input.split(' ')[1];
    //Ñ‡ÐµÑ€ÐµÐ· id Ð¼Ð¾Ð¶Ð½Ð¾ Ð²Ñ‹Ñ‚ÑÐ½ÑƒÑ‚ÑŒ Ñ†ÐµÐ½Ñƒ Ð¸Ð· ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ð¸

    return ctx.replyWithMarkdownV2(`ðŸ’¸ÐžÐ¿Ð»Ð°Ñ‚Ð° Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ñ‚ Ð½Ðµ Ñ‡ÐµÑ€ÐµÐ· ÑÐ°Ð¹Ñ‚, Ð° Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ Ð½Ð° Ð½Ð°Ñˆ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾ÐºÐ¾ÑˆÐµÐ»ÐµÐº, Ñ‚Ð°ÐºÐ¸Ð¼ Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð¼ Ð²Ñ‹ :
\\- Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÑ‚Ðµ NFT Ð¿Ð¾ Ð·Ð°Ð½Ð¸Ð¶ÐµÐ½Ð¾Ð¹ Ñ†ÐµÐ½Ðµ
\\- Ð½Ðµ Ñ‚ÐµÑ€ÑÐµÑ‚Ðµ Ð´ÐµÐ½ÑŒÐ³Ð¸ Ð½Ð° ÐºÐ¾Ð¼Ð¸ÑÑÐ¸ÑŽ
\\- ÑÐºÐ¾Ð½Ð¾Ð¼Ð¸Ñ‚Ðµ Ð²Ñ€ÐµÐ¼Ñ
ðŸ’¸ÐŸÐ¾ÑÐ»Ðµ Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹, Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ Ñ…ÑÑˆ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð¸ ÑÐºÑ€Ð¸Ð½ÑˆÐ¾Ñ‚ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ñƒ : @manager
ðŸ’¸ÐšÐ¾ÑˆÐµÐ»ÐµÐº Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´Ð° *USDT Ð² ÑÐµÑ‚Ð¸ TRC20* : \`TR7NHqjeKQxGTCi8000000000000000\` `, {
        ...Markup.inlineKeyboard([
            Markup.button.callback('Ð¯ Ð¾Ð¿Ð»Ð°Ñ‚Ð¸Ð»', 'paid'),
        ])
    })
})

bot.action("paid", (ctx, next) => {
    return ctx.reply('ðŸ’¸Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð·Ð° Ð¿Ð¾ÐºÑƒÐ¿ÐºÑƒ! ÐÐµ Ð·Ð°Ð±ÑƒÐ´ÑŒÑ‚Ðµ ÑÐ²ÑÐ·Ð°Ñ‚ÑŒÑÑ Ñ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð¼ Ð¸ Ð¾Ð¶Ð¸Ð´Ð°Ð¹Ñ‚Ðµ 15-30 Ð¼Ð¸Ð½ÑƒÑ‚', {
    })
})

//ÐÐ”ÐœÐ†ÐÐšÐ (Ð”ÐžÐ‘ÐÐ’Ð›Ð¯Ð¢Ð˜ ÐÐ¤Ð¢)
bot.command('admin', async (ctx) => {
    //if(!process.env.ADMINS.includes(ctx.chat.id)) return;

    await ctx.reply('Ñƒ Ñ€Ð¾Ð·Ñ€Ð¾Ð±Ñ†Ñ– : Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚Ð¸/Ð²Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸ NFT', {
        ...Markup.inlineKeyboard([
            Markup.button.callback('ÐŸÐµÑ€ÐµÐ³Ð»ÑÐ½ÑƒÑ‚Ð¸ Ð²ÑÑ– ÐºÐ¾Ð»ÐµÐºÑ†Ñ–Ñ—', 'collection_list'),
            Markup.button.callback('Ð”Ð¾Ð´Ð°Ñ‚Ð¸ ÐºÐ¾Ð»ÐµÐºÑ†Ñ–ÑŽ', 'add_collection'),
            Markup.button.callback('Ð’Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸ ÐºÐ¾Ð»ÐµÐºÑ†Ñ–ÑŽ', 'collection_delete'),
        ])
    })
});

bot.action('collection_delete', (ctx, next) => {
    //if(!process.env.ADMINS.includes(ctx.chat.id)) return;
    return ctx.scene.enter('delete_collection');
});

bot.action('add_collection', (ctx, next) => {
    //if(!process.env.ADMINS.includes(ctx.chat.id)) return;
    return ctx.scene.enter('add_collection');
});

bot.action('collection_list', async (ctx, next) => {
    //if(!process.env.ADMINS.includes(ctx.chat.id)) return;
    const collections = await getAllCollections();

    return ctx.replyWithHTML(`${collections.map(item => `id:${item.id} | price:${item.price} | link:${item.link}`).join('\n')}`, { 
        disable_web_page_preview: true 
    })
});

//Ð—ÐÐŸÐ£Ð¡Ðš
bot.launch();

process.once('SIGINT', () => bot.stop('SIGINT'));
process.once('SIGTERM', () => bot.stop('SIGTERM')); 